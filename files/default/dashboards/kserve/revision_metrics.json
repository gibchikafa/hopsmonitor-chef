{
  "annotations":{
    "list":[
      {
        "builtIn":1,
        "datasource":"-- Grafana --",
        "enable":true,
        "hide":true,
        "iconColor":"rgba(0, 211, 255, 1)",
        "name":"Annotations & Alerts",
        "type":"dashboard"
      }
    ]
  },
  "description":"KServe - Revision HTTP Requests",
  "editable":false,
  "gnetId":null,
  "graphTooltip":0,
  "links":[

  ],
  "panels":[
    {
      "collapsed":false,
      "gridPos":{
        "h":1,
        "w":24,
        "x":0,
        "y":0
      },
      "id":8,
      "panels":[

      ],
      "title":"Summary metrics (average over the selected time range)",
      "type":"row"
    },
    {
      "cacheTimeout":null,
      "colorBackground":false,
      "colorValue":false,
      "colors":[
        "#299c46",
        "rgba(237, 129, 40, 0.89)",
        "#d44a3a"
      ],
      "datasource":"Prometheus",
      "format":"ops",
      "gauge":{
        "maxValue":100,
        "minValue":0,
        "show":false,
        "thresholdLabels":false,
        "thresholdMarkers":true
      },
      "gridPos":{
        "h":4,
        "w":6,
        "x":0,
        "y":1
      },
      "id":2,
      "interval":null,
      "links":[

      ],
      "mappingType":1,
      "mappingTypes":[
        {
          "name":"value to text",
          "value":1
        },
        {
          "name":"range to text",
          "value":2
        }
      ],
      "maxDataPoints":100,
      "nullPointMode":"connected",
      "nullText":null,
      "postfix":"",
      "postfixFontSize":"50%",
      "prefix":"",
      "prefixFontSize":"50%",
      "rangeMaps":[
        {
          "from":"null",
          "text":"N/A",
          "to":"null"
        }
      ],
      "repeat":null,
      "repeatDirection":"v",
      "sparkline":{
        "fillColor":"rgba(31, 118, 189, 0.18)",
        "full":true,
        "lineColor":"rgb(31, 120, 193)",
        "show":true
      },
      "tableColumn":"",
      "targets":[
        {
          "expr":"round(sum(rate(revision_request_count{namespace_name=\"$namespace\", revision_name=~\"$revision\", configuration_name=~\"$configuration\"}[1m])), 0.001)",
          "format":"time_series",
          "hide":false,
          "interval":"",
          "intervalFactor":1,
          "refId":"A"
        }
      ],
      "thresholds":"",
      "title":"Request Volume",
      "type":"singlestat",
      "valueFontSize":"80%",
      "valueMaps":[
        {
          "op":"=",
          "text":"N/A",
          "value":"null"
        }
      ],
      "valueName":"avg"
    },
    {
      "cacheTimeout":null,
      "colorBackground":false,
      "colorValue":false,
      "colors":[
        "#d44a3a",
        "rgba(237, 129, 40, 0.89)",
        "#299c46"
      ],
      "datasource":"Prometheus",
      "format":"percentunit",
      "gauge":{
        "maxValue":100,
        "minValue":0,
        "show":false,
        "thresholdLabels":false,
        "thresholdMarkers":true
      },
      "gridPos":{
        "h":4,
        "w":6,
        "x":6,
        "y":1
      },
      "id":4,
      "interval":null,
      "links":[

      ],
      "mappingType":1,
      "mappingTypes":[
        {
          "name":"value to text",
          "value":1
        },
        {
          "name":"range to text",
          "value":2
        }
      ],
      "maxDataPoints":100,
      "nullPointMode":"connected",
      "nullText":null,
      "postfix":"",
      "postfixFontSize":"50%",
      "prefix":"",
      "prefixFontSize":"50%",
      "rangeMaps":[
        {
          "from":"null",
          "text":"N/A",
          "to":"null"
        }
      ],
      "sparkline":{
        "fillColor":"rgba(31, 118, 189, 0.18)",
        "full":true,
        "lineColor":"rgb(31, 120, 193)",
        "show":true
      },
      "tableColumn":"",
      "targets":[
        {
          "expr":"sum(rate(revision_request_count{response_code_class!=\"5xx\", namespace_name=\"$namespace\", revision_name=~\"$revision\", configuration_name=~\"$configuration\"}[1m])) / sum(rate(revision_request_count{namespace_name=\"$namespace\", revision_name=~\"$revision\", configuration_name=~\"$configuration\"}[1m]))",
          "format":"time_series",
          "interval":"",
          "intervalFactor":1,
          "refId":"A"
        }
      ],
      "thresholds":"95, 99, 99.5",
      "title":"Success Rate (non-5xx responses)",
      "type":"singlestat",
      "valueFontSize":"80%",
      "valueMaps":[
        {
          "op":"=",
          "text":"N/A",
          "value":"null"
        }
      ],
      "valueName":"avg"
    },
    {
      "cacheTimeout":null,
      "colorBackground":false,
      "colorValue":false,
      "colors":[
        "#d44a3a",
        "rgba(237, 129, 40, 0.89)",
        "#299c46"
      ],
      "datasource":"Prometheus",
      "format":"ops",
      "gauge":{
        "maxValue":100,
        "minValue":0,
        "show":false,
        "thresholdLabels":false,
        "thresholdMarkers":true
      },
      "gridPos":{
        "h":4,
        "w":6,
        "x":12,
        "y":1
      },
      "id":5,
      "interval":null,
      "links":[

      ],
      "mappingType":1,
      "mappingTypes":[
        {
          "name":"value to text",
          "value":1
        },
        {
          "name":"range to text",
          "value":2
        }
      ],
      "maxDataPoints":100,
      "nullPointMode":"connected",
      "nullText":null,
      "postfix":"",
      "postfixFontSize":"50%",
      "prefix":"",
      "prefixFontSize":"50%",
      "rangeMaps":[
        {
          "from":"null",
          "text":"N/A",
          "to":"null"
        }
      ],
      "sparkline":{
        "fillColor":"rgba(31, 118, 189, 0.18)",
        "full":true,
        "lineColor":"rgb(31, 120, 193)",
        "show":true
      },
      "tableColumn":"",
      "targets":[
        {
          "expr":"sum(rate(revision_request_count{response_code_class=\"4xx\", namespace_name=\"$namespace\", revision_name=~\"$revision\", configuration_name=~\"$configuration\"}[1m])) ",
          "format":"time_series",
          "interval":"",
          "intervalFactor":1,
          "refId":"A"
        }
      ],
      "thresholds":"",
      "title":"4xx (Client Error)",
      "type":"singlestat",
      "valueFontSize":"80%",
      "valueMaps":[
        {
          "op":"=",
          "text":"N/A",
          "value":"null"
        }
      ],
      "valueName":"avg"
    },
    {
      "cacheTimeout":null,
      "colorBackground":false,
      "colorValue":false,
      "colors":[
        "#d44a3a",
        "rgba(237, 129, 40, 0.89)",
        "#299c46"
      ],
      "datasource":"Prometheus",
      "format":"ops",
      "gauge":{
        "maxValue":100,
        "minValue":0,
        "show":false,
        "thresholdLabels":false,
        "thresholdMarkers":true
      },
      "gridPos":{
        "h":4,
        "w":6,
        "x":18,
        "y":1
      },
      "id":9,
      "interval":null,
      "links":[

      ],
      "mappingType":1,
      "mappingTypes":[
        {
          "name":"value to text",
          "value":1
        },
        {
          "name":"range to text",
          "value":2
        }
      ],
      "maxDataPoints":100,
      "nullPointMode":"connected",
      "nullText":null,
      "postfix":"",
      "postfixFontSize":"50%",
      "prefix":"",
      "prefixFontSize":"50%",
      "rangeMaps":[
        {
          "from":"null",
          "text":"N/A",
          "to":"null"
        }
      ],
      "sparkline":{
        "fillColor":"rgba(31, 118, 189, 0.18)",
        "full":true,
        "lineColor":"rgb(31, 120, 193)",
        "show":true
      },
      "tableColumn":"",
      "targets":[
        {
          "expr":"sum(rate(revision_request_count{response_code_class=\"5xx\", namespace_name=\"$namespace\", revision_name=~\"$revision\", configuration_name=~\"$configuration\"}[1m])) ",
          "format":"time_series",
          "interval":"",
          "intervalFactor":1,
          "refId":"A"
        }
      ],
      "thresholds":"",
      "title":"5xx (Server Error)",
      "type":"singlestat",
      "valueFontSize":"80%",
      "valueMaps":[
        {
          "op":"=",
          "text":"N/A",
          "value":"null"
        }
      ],
      "valueName":"avg"
    },
    {
      "collapsed":false,
      "gridPos":{
        "h":1,
        "w":24,
        "x":0,
        "y":5
      },
      "id":11,
      "panels":[

      ],
      "title":"Request Volume",
      "type":"row"
    },
    {
      "aliasColors":{

      },
      "bars":false,
      "dashLength":10,
      "dashes":false,
      "datasource":"Prometheus",
      "fill":1,
      "gridPos":{
        "h":10,
        "w":12,
        "x":0,
        "y":6
      },
      "id":17,
      "legend":{
        "avg":false,
        "current":false,
        "max":false,
        "min":false,
        "show":true,
        "total":false,
        "values":false
      },
      "lines":true,
      "linewidth":1,
      "links":[

      ],
      "nullPointMode":"null",
      "percentage":false,
      "pointradius":5,
      "points":false,
      "renderer":"flot",
      "seriesOverrides":[

      ],
      "spaceLength":10,
      "stack":false,
      "steppedLine":false,
      "targets":[
        {
          "expr":"round(sum(rate(revision_request_count{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\"}[1m])) by (revision_name), 0.001)",
          "format":"time_series",
          "interval":"",
          "intervalFactor":1,
          "legendFormat":"{{revision_name}}",
          "refId":"A"
        }
      ],
      "thresholds":[

      ],
      "timeFrom":null,
      "timeShift":null,
      "title":"Number of requests per second by Revision",
      "tooltip":{
        "shared":true,
        "sort":2,
        "value_type":"individual"
      },
      "type":"graph",
      "xaxis":{
        "buckets":null,
        "mode":"time",
        "name":null,
        "show":true,
        "values":[

        ]
      },
      "yaxes":[
        {
          "format":"ops",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        },
        {
          "format":"short",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        }
      ]
    },
    {
      "aliasColors":{

      },
      "bars":false,
      "dashLength":10,
      "dashes":false,
      "datasource":"Prometheus",
      "fill":1,
      "gridPos":{
        "h":10,
        "w":12,
        "x":12,
        "y":6
      },
      "id":18,
      "legend":{
        "avg":false,
        "current":false,
        "max":false,
        "min":false,
        "show":true,
        "total":false,
        "values":false
      },
      "lines":true,
      "linewidth":1,
      "links":[

      ],
      "nullPointMode":"null",
      "percentage":false,
      "pointradius":5,
      "points":false,
      "renderer":"flot",
      "seriesOverrides":[

      ],
      "spaceLength":10,
      "stack":false,
      "steppedLine":false,
      "targets":[
        {
          "expr":"round(sum(rate(revision_request_count{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\"}[1m])) by (response_code_class), 0.001)",
          "format":"time_series",
          "interval":"",
          "intervalFactor":1,
          "legendFormat":"{{ response_code_class }}",
          "refId":"A"
        }
      ],
      "thresholds":[

      ],
      "timeFrom":null,
      "timeShift":null,
      "title":"Number of requests per second by HTTP Response Code Class",
      "tooltip":{
        "shared":true,
        "sort":2,
        "value_type":"individual"
      },
      "type":"graph",
      "xaxis":{
        "buckets":null,
        "mode":"time",
        "name":null,
        "show":true,
        "values":[

        ]
      },
      "yaxes":[
        {
          "format":"ops",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        },
        {
          "format":"short",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        }
      ]
    },
    {
      "collapsed":false,
      "gridPos":{
        "h":1,
        "w":24,
        "x":0,
        "y":16
      },
      "id":15,
      "panels":[

      ],
      "title":"Latencies",
      "type":"row"
    },
    {
      "aliasColors":{

      },
      "bars":false,
      "dashLength":10,
      "dashes":false,
      "datasource":"Prometheus",
      "fill":1,
      "gridPos":{
        "h":9,
        "w":8,
        "x":0,
        "y":17
      },
      "id":20,
      "legend":{
        "alignAsTable":false,
        "avg":true,
        "current":false,
        "hideEmpty":false,
        "hideZero":false,
        "max":false,
        "min":false,
        "rightSide":false,
        "show":true,
        "total":false,
        "values":true
      },
      "lines":true,
      "linewidth":1,
      "links":[

      ],
      "nullPointMode":"null",
      "percentage":false,
      "pointradius":5,
      "points":false,
      "renderer":"flot",
      "seriesOverrides":[

      ],
      "spaceLength":10,
      "stack":false,
      "steppedLine":false,
      "targets":[
        {
          "expr":"sum(histogram_quantile(0.99, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\"}[1m])) by (revision_name, le))) + sum(label_join((histogram_quantile(0.99, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\", destination_canonical_service=\"istio-ingressgateway\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000)) or histogram_quantile(0.99, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\", destination_canonical_service=\"istio-ingressgateway\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace)), \"destination_workload_var\", \".\", \"destination_workload\", \"destination_workload_namespace\")) + sum(histogram_quantile(0.99, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\", destination_canonical_service=\"activator\", destination_service_name=\"$revision\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000) or histogram_quantile(0.99, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\", destination_canonical_service=\"activator\", destination_service_name=\"$revision\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace)))",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"p99",
          "refId":"A"
        },
        {
          "expr":"sum(histogram_quantile(0.90, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\"}[1m])) by (revision_name, le))) + sum(label_join((histogram_quantile(0.90, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\", destination_canonical_service=\"istio-ingressgateway\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000)) or histogram_quantile(0.90, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\", destination_canonical_service=\"istio-ingressgateway\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace)), \"destination_workload_var\", \".\", \"destination_workload\", \"destination_workload_namespace\")) + sum(histogram_quantile(0.90, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\", destination_canonical_service=\"activator\", destination_service_name=\"$revision\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000) or histogram_quantile(0.90, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\", destination_canonical_service=\"activator\", destination_service_name=\"$revision\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace)))",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"p90",
          "refId":"B"
        },
        {
          "expr":"sum(histogram_quantile(0.50, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\"}[1m])) by (revision_name, le))) + sum(label_join((histogram_quantile(0.50, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\", destination_canonical_service=\"istio-ingressgateway\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000)) or histogram_quantile(0.50, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\", destination_canonical_service=\"istio-ingressgateway\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace)), \"destination_workload_var\", \".\", \"destination_workload\", \"destination_workload_namespace\")) + sum(histogram_quantile(0.50, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\", destination_canonical_service=\"activator\", destination_service_name=\"$revision\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000) or histogram_quantile(0.50, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\", destination_canonical_service=\"activator\", destination_service_name=\"$revision\", source_canonical_service=\"istio-ingressgateway\"}[1m])) by (le, destination_workload, destination_workload_namespace)))",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"p50",
          "refId":"C"
        }
      ],
      "thresholds":[

      ],
      "timeFrom":null,
      "timeShift":null,
      "title":"End to end Latencies",
      "tooltip":{
        "shared":true,
        "sort":2,
        "value_type":"individual"
      },
      "type":"graph",
      "xaxis":{
        "buckets":null,
        "mode":"time",
        "name":null,
        "show":true,
        "values":[

        ]
      },
      "yaxes":[
        {
          "format":"ms",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        },
        {
          "format":"short",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":false
        }
      ]
    },
    {
      "aliasColors":{

      },
      "bars":false,
      "dashLength":10,
      "dashes":false,
      "datasource":"Prometheus",
      "fill":1,
      "gridPos":{
        "h":9,
        "w":8,
        "x":8,
        "y":17
      },
      "id":21,
      "legend":{
        "alignAsTable":false,
        "avg":true,
        "current":false,
        "hideEmpty":false,
        "hideZero":false,
        "max":false,
        "min":false,
        "rightSide":false,
        "show":true,
        "total":false,
        "values":true
      },
      "lines":true,
      "linewidth":1,
      "links":[

      ],
      "nullPointMode":"null",
      "percentage":false,
      "pointradius":5,
      "points":false,
      "renderer":"flot",
      "seriesOverrides":[

      ],
      "spaceLength":10,
      "stack":false,
      "steppedLine":false,
      "targets":[
        {
          "expr":"histogram_quantile(0.50, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\"}[1m])) by (revision_name, le))",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"{{ revision_name }} (p50)",
          "refId":"A"
        },
        {
          "expr":"histogram_quantile(0.99, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\"}[1m])) by (revision_name, le))",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"{{ revision_name }} (p99)",
          "refId":"B"
        },
        {
          "expr":"label_join((histogram_quantile(0.50, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000)) or histogram_quantile(0.50, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\"}[1m])) by (le, destination_workload, destination_workload_namespace)), \"destination_workload_var\", \".\", \"destination_workload\", \"destination_workload_namespace\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"{{ destination_workload }}.{{ destination_workload_namespace }} (p50)",
          "refId":"C"
        },
        {
          "expr":"label_join((histogram_quantile(0.99, sum(rate(istio_request_duration_milliseconds_bucket{reporter=\"source\"}[1m])) by (le, destination_workload, destination_workload_namespace) / 1000)) or histogram_quantile(0.99, sum(rate(istio_request_duration_seconds_bucket{reporter=\"source\"}[1m])) by (le, destination_workload, destination_workload_namespace)), \"destination_workload_var\", \".\", \"destination_workload\", \"destination_workload_namespace\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"{{ destination_workload }}.{{ destination_workload_namespace }} (p99)",
          "refId":"D"
        }
      ],
      "thresholds":[

      ],
      "timeFrom":null,
      "timeShift":null,
      "title":"Breakdown of Latencies",
      "tooltip":{
        "shared":true,
        "sort":2,
        "value_type":"individual"
      },
      "type":"graph",
      "xaxis":{
        "buckets":null,
        "mode":"time",
        "name":null,
        "show":true,
        "values":[

        ]
      },
      "yaxes":[
        {
          "format":"ms",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        },
        {
          "format":"short",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":false
        }
      ]
    },
    {
      "aliasColors":{

      },
      "bars":false,
      "dashLength":10,
      "dashes":false,
      "datasource":"Prometheus",
      "fill":1,
      "gridPos":{
        "h":9,
        "w":8,
        "x":16,
        "y":17
      },
      "id":22,
      "legend":{
        "alignAsTable":false,
        "avg":true,
        "current":false,
        "hideEmpty":false,
        "hideZero":false,
        "max":false,
        "min":false,
        "rightSide":false,
        "show":true,
        "total":false,
        "values":true
      },
      "lines":true,
      "linewidth":1,
      "links":[

      ],
      "nullPointMode":"null",
      "percentage":false,
      "pointradius":5,
      "points":false,
      "renderer":"flot",
      "seriesOverrides":[

      ],
      "spaceLength":10,
      "stack":false,
      "steppedLine":false,
      "targets":[
        {
          "expr":"label_replace(histogram_quantile(0.50, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"2xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Success: 2xx (p50)",
          "refId":"C"
        },
        {
          "expr":"label_replace(histogram_quantile(0.50, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"3xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Redirection: 3xx (p50)",
          "refId":"D"
        },
        {
          "expr":"label_replace(histogram_quantile(0.50, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"4xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Client Error: 4xx (p50)",
          "refId":"A"
        },
        {
          "expr":"label_replace(histogram_quantile(0.50, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"5xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Server Error: 5xx (p50)",
          "refId":"B"
        },
        {
          "expr":"label_replace(histogram_quantile(0.95, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"2xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Sucess: 2xx (p95)",
          "refId":"E"
        },
        {
          "expr":"label_replace(histogram_quantile(0.95, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"3xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Redirection: 3xx (p95)",
          "refId":"F"
        },
        {
          "expr":"label_replace(histogram_quantile(0.95, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"4xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Client Error: 4xx (p95)",
          "refId":"G"
        },
        {
          "expr":"label_replace(histogram_quantile(0.95, sum(rate(revision_request_latencies_bucket{namespace_name=\"$namespace\", configuration_name=~\"$configuration\",revision_name=~\"$revision\",response_code_class=\"5xx\"}[1m])) by (le)), \"revision_name\", \"$2\", \"revision_name\", \"$configuration(-+)(.*)\")",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Server Error: 5xx (p95)",
          "refId":"H"
        }
      ],
      "thresholds":[

      ],
      "timeFrom":null,
      "timeShift":null,
      "title":"Application Latencies by HTTP Response Code Class",
      "tooltip":{
        "shared":true,
        "sort":2,
        "value_type":"individual"
      },
      "type":"graph",
      "xaxis":{
        "buckets":null,
        "mode":"time",
        "name":null,
        "show":true,
        "values":[

        ]
      },
      "yaxes":[
        {
          "format":"ms",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        },
        {
          "format":"short",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":false
        }
      ]
    },
    {
      "collapsed":false,
      "gridPos":{
        "h":1,
        "w":24,
        "x":0,
        "y":18
      },
      "id":23,
      "panels":[

      ],
      "title":"Resource Usage",
      "type":"row"
    },
    {
      "aliasColors":{

      },
      "bars":false,
      "dashLength":10,
      "dashes":false,
      "datasource":"Prometheus",
      "fill":1,
      "gridPos":{
        "h":9,
        "w":12,
        "x":0,
        "y":19
      },
      "id":24,
      "legend":{
        "alignAsTable":false,
        "avg":true,
        "current":false,
        "hideEmpty":false,
        "hideZero":false,
        "max":false,
        "min":false,
        "rightSide":false,
        "show":true,
        "total":false,
        "values":true
      },
      "lines":true,
      "linewidth":1,
      "links":[

      ],
      "nullPointMode":"null",
      "percentage":false,
      "pointradius":5,
      "points":false,
      "renderer":"flot",
      "seriesOverrides":[

      ],
      "spaceLength":10,
      "stack":false,
      "steppedLine":false,
      "targets":[
        {
          "expr":"sum(kube_pod_container_resource_requests_cpu_cores{exported_namespace=\"$namespace\", exported_pod=~\"$revision-deployment-.*\"})",
          "format":"time_series",
          "interval":"",
          "intervalFactor":1,
          "legendFormat":"Cores requested",
          "refId":"A"
        },
        {
          "expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", pod=~\"$revision-deployment-.*\", container=\"\"}[1m]))",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Cores used",
          "refId":"B"
        },
        {
          "expr":"sum(kube_pod_container_resource_limits_cpu_cores{exported_namespace=\"$namespace\", exported_pod=~\"$revision-deployment-.*\"})",
          "format":"time_series",
          "intervalFactor":1,
          "legendFormat":"Core limit",
          "refId":"C"
        }
      ],
      "thresholds":[

      ],
      "timeFrom":null,
      "timeShift":null,
      "title":"Revision CPU Usage",
      "tooltip":{
        "shared":true,
        "sort":2,
        "value_type":"individual"
      },
      "type":"graph",
      "xaxis":{
        "buckets":null,
        "mode":"time",
        "name":null,
        "show":true,
        "values":[

        ]
      },
      "yaxes":[
        {
          "format":"ms",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        },
        {
          "format":"short",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":false
        }
      ]
    },
    {
      "aliasColors":{

      },
      "bars":false,
      "dashLength":10,
      "dashes":false,
      "datasource":"Prometheus",
      "fill":1,
      "gridPos":{
        "h":9,
        "w":12,
        "x":12,
        "y":19
      },
      "id":25,
      "legend":{
        "avg":false,
        "current":false,
        "max":false,
        "min":false,
        "show":true,
        "total":false,
        "values":false
      },
      "lines":true,
      "linewidth":1,
      "links":[

      ],
      "nullPointMode":"null",
      "percentage":false,
      "pointradius":5,
      "points":false,
      "renderer":"flot",
      "seriesOverrides":[

      ],
      "spaceLength":10,
      "stack":false,
      "steppedLine":false,
      "targets":[
        {
          "expr":"sum(kube_pod_container_resource_requests_memory_bytes{exported_namespace=\"$namespace\", exported_pod=~\"$revision-deployment-.*\"})",
          "format":"time_series",
          "interval":"",
          "intervalFactor":1,
          "legendFormat":"Memory requested",
          "refId":"A"
        },
        {
          "expr":"sum(container_memory_usage_bytes{namespace=\"$namespace\", pod=~\"$revision-deployment-.*\"})",
          "format":"time_series",
          "hide":false,
          "intervalFactor":1,
          "legendFormat":"Memory used",
          "refId":"B"
        },
        {
          "expr":"sum(kube_pod_container_resource_limits_memory_bytes{exported_namespace=\"$namespace\", exported_pod=~\"$revision-deployment-.*\"})",
          "format":"time_series",
          "intervalFactor":1,
          "refId":"C"
        }
      ],
      "thresholds":[

      ],
      "timeFrom":null,
      "timeShift":null,
      "title":"Pod Memory Usage",
      "tooltip":{
        "shared":true,
        "sort":2,
        "value_type":"individual"
      },
      "type":"graph",
      "xaxis":{
        "buckets":null,
        "mode":"time",
        "name":null,
        "show":true,
        "values":[

        ]
      },
      "yaxes":[
        {
          "format":"decbytes",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":true
        },
        {
          "format":"short",
          "label":null,
          "logBase":1,
          "max":null,
          "min":null,
          "show":false
        }
      ]
    }
  ],
  "refresh":"5s",
  "schemaVersion":16,
  "style":"dark",
  "tags":[
    "Knative"
  ],
  "templating":{
    "list":[
      {
        "allValue":null,
        "current":{

        },
        "datasource":"Prometheus",
        "hide":0,
        "includeAll":false,
        "label":"Namespace",
        "multi":false,
        "name":"namespace",
        "options":[

        ],
        "query":"label_values(revision_request_count{namespace_name!=\"unknown\"}, namespace_name)",
        "refresh":1,
        "regex":"",
        "sort":1,
        "tagValuesQuery":"",
        "tags":[

        ],
        "tagsQuery":"",
        "type":"query",
        "useTags":false
      },
      {
        "allValue":null,
        "current":{

        },
        "datasource":"Prometheus",
        "hide":0,
        "includeAll":false,
        "label":"Configuration",
        "multi":false,
        "name":"configuration",
        "options":[

        ],
        "query":"label_values(revision_request_count{namespace_name=\"$namespace\", configuration_name!=\"unknown\"}, configuration_name)",
        "refresh":1,
        "regex":"",
        "sort":1,
        "tagValuesQuery":"$tag",
        "tags":[

        ],
        "tagsQuery":"",
        "type":"query",
        "useTags":false
      },
      {
        "allValue":null,
        "current":{

        },
        "datasource":"Prometheus",
        "hide":0,
        "includeAll":true,
        "label":"Revision",
        "multi":true,
        "name":"revision",
        "options":[

        ],
        "query":"label_values(revision_request_count{namespace_name=\"$namespace\", configuration_name=~\"$configuration\", revision_name!=\"unknown\"}, revision_name)",
        "refresh":1,
        "regex":"",
        "sort":2,
        "tagValuesQuery":"",
        "tags":[

        ],
        "tagsQuery":"",
        "type":"query",
        "useTags":false
      }
    ]
  },
  "time":{
    "from":"now-15m",
    "to":"now"
  },
  "timepicker":{
    "refresh_intervals":[
      "5s",
      "10s",
      "30s",
      "1m",
      "5m",
      "15m",
      "30m",
      "1h",
      "2h",
      "1d"
    ],
    "time_options":[
      "5m",
      "15m",
      "1h",
      "6h",
      "12h",
      "24h",
      "2d",
      "7d",
      "30d"
    ]
  },
  "timezone":"",
  "title":"KServing",
  "uid":"kserve",
  "version":2
}